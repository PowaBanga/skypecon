// Override certain styles when on a retina device.
// Essentially this forces the .sc-2x class but adjusts the background-size to be 50%.
@media
only screen and (-webkit-min-device-pixel-ratio: @retina-factor),
only screen and (   min--moz-device-pixel-ratio: @retina-factor),
only screen and (   -moz-min-device-pixel-ratio: @retina-factor),
only screen and (     -o-min-device-pixel-ratio: @retina-factor/1),
only screen and (        min-device-pixel-ratio: @retina-factor),
only screen and (                min-resolution: 192dpi),
only screen and (                min-resolution: ~"@{retina-factor}dppx") {

  .sc,
  .sc.sc-2x {
    width: unit(@width, px);
    height: unit(@height, px);

    //background-size: 50%;
    background-size: unit(@width, px);
  }

  .sc.sc-still,
  .sc.sc-hover {
    background-image: %(~"url(%s%s%s.png)", @path, @basename-stills-sprite, @basename-suffix-retina);
  }

  // Dummy mixin to perform the loop
  .loop(@indx: 1) when (@indx < length(@icons)) {

    @itr-key:            extract(@icons, @indx);
    @itr-height-anim-2x: (@itr-height-anim * 2);

    @-webkit-keyframes ~'@{animation-name-prefix}@{itr-key}@{animation-name-suffix}' {
        0% { background-position: 0 0; }
        100% { background-position: 0 (-1 * unit(@itr-height-anim-2x, px)); }
    }
    @keyframes ~'@{animation-name-prefix}@{itr-key}@{animation-name-suffix}' {
        0% { background-position: 0 0; }
        100% { background-position: 0 (-1 * unit(@itr-height-anim-2x, px)); }
    }

    /*
    .sc.sc-@{itr-key} {
      //background-size: 50%;
      background-size: 20px;
      background-image: ~"url(@{path}@{itr-key}@{basename-suffix-frames-sprite}@{basename-suffix-retina}.png)";
    }
    */

    .sc.sc-still.sc-@{itr-key} {
      //background-size: 50%;
      background-size: unit(@width, px);

      background-position: (-1 * unit(((@indx - 1) * @width), px)) 0;
    }
  
    .sc.sc-@{itr-key} {
      background-image: %(~"url(%s%d%s%s.png)", @path, @itr-key, @basename-suffix-frames-sprite, @basename-suffix-retina);
    }
  
    // Repeat the loop
    .loop(@indx + @list-interval);
  }

  // Initialize the loop call
  .loop();
}
